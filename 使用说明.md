# 易损清单生成工具使用说明

## 功能介绍

本工具用于生成设备易损清单，主要功能包括：

1. **设备清单维护**：维护已知黑白名单设备，包括物料编号、备件数、单位、机型、备注和状态
2. **批量处理Excel文件**：自动读取项目文件夹中的Excel文件，提取ERP编号
3. **智能匹配**：将ERP编号与维护的设备清单进行匹配
4. **手动判断**：对未识别的设备，提供手动判断是否易损的功能
5. **生成易损清单**：导出最终的易损清单Excel文件

## 操作步骤

### 一、设备清单维护

1. 在"设备清单维护"标签页中，填写设备信息：
   - 物料编号：设备的唯一标识（必填）
   - 备件数：易损件的数量
   - 单位：数量单位
   - 机型：设备型号
   - 备注：其他说明信息
   - 状态：选择白名单（易损）或黑名单（不易损）

2. 点击"添加设备"按钮，将设备添加到清单中

3. 点击"保存设备清单"按钮，将设备清单保存到本地文件

4. 点击"加载设备清单"按钮，可以加载之前保存的设备清单

### 二、生成易损清单

1. 在"生成易损清单"标签页中，点击"选择项目文件夹"按钮，选择包含Excel文件的项目文件夹

2. 系统会自动识别文件夹中的Excel文件，并显示文件数量和列表

3. 点击"处理文件"按钮，开始处理所有Excel文件

4. 处理完成后，系统会显示：
   - 处理结果统计（总文件数、总设备数、匹配情况）
   - 易损清单结果（白名单设备）
   - 未识别设备列表（如果有）

5. 对于未识别的设备，在表格中填写相关信息并选择"是否易损"，然后点击"确认选择"按钮

6. 点击"导出易损清单"按钮，选择保存位置，导出最终的易损清单Excel文件

## 注意事项

1. Excel文件中必须包含"ERP"或"ERP编号"列
2. 设备清单会自动保存，下次打开应用时会自动加载
3. 用户手动判断的设备会自动添加到设备清单中
4. 白名单设备会被包含在易损清单中，黑名单设备会被排除

## 文件说明

- `main.js`：Electron主进程文件，处理文件选择和保存
- `index.html`：应用界面文件
- `renderer.js`：渲染进程文件，实现核心功能
- `devices.json`：设备清单数据文件
- `package.json`：项目配置文件

## 技术栈

- Electron：桌面应用框架
- Node.js：运行环境
- XLSX：Excel文件处理库
- fs-extra：文件操作库

## 启动方式

1. 安装依赖：`npm install`
2. 启动应用：`npm start`
3. 打包应用：`npx electron-packager . 易损清单生成工具 --platform=win32 --arch=x64 --out=dist --overwrite`

## 常见问题

1. **无法启动应用**：请检查Node.js是否已安装，依赖是否安装成功
2. **Excel文件无法识别**：请确保Excel文件中包含"ERP"或"ERP编号"列
3. **设备匹配失败**：请检查设备清单中的物料编号是否与Excel中的ERP编号一致
4. **导出文件失败**：请检查保存路径是否有写入权限

## 更新日志

- v1.0.0：初始版本，实现基本功能

---

如果您在使用过程中遇到问题，请检查日志输出或联系开发人员。